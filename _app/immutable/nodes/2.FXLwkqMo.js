import{i as z,f as H,h as A,j as q,s as G,n as P}from"../chunks/scheduler.FBjjn5oP.js";import{p as $,t as F,b as K,d as Q,S as X,i as Y,g,s as O,m as b,h as k,j as B,y as U,c as j,n as _,f as E,k as D,a as S,x as c,z as Z,o as y}from"../chunks/index.Yx7fxxdr.js";import{w as tt,b as et}from"../chunks/paths.0eo8JzcN.js";function J(e,t){const l=t.token={};function s(n,a,r,u){if(t.token!==l)return;t.resolved=u;let p=t.ctx;r!==void 0&&(p=p.slice(),p[r]=u);const h=n&&(t.current=n)(p);let w=!1;t.block&&(t.blocks?t.blocks.forEach((d,f)=>{f!==a&&d&&($(),F(d,1,1,()=>{t.blocks[f]===d&&(t.blocks[f]=null)}),K())}):t.block.d(1),h.c(),Q(h,1),h.m(t.mount(),t.anchor),w=!0),t.block=h,t.blocks&&(t.blocks[a]=h),w&&q()}if(z(e)){const n=H();if(e.then(a=>{A(n),s(t.then,1,t.value,a),A(null)},a=>{if(A(n),s(t.catch,2,t.error,a),A(null),!t.hasCatch)throw a}),t.current!==t.pending)return s(t.pending,0),!0}else{if(t.current!==t.then)return s(t.then,1,t.value,e),!0;t.resolved=e}}function at(e,t,l){const s=t.slice(),{resolved:n}=e;e.current===e.then&&(s[e.value]=n),e.current===e.catch&&(s[e.error]=n),e.block.p(s,l)}const L=tt({valid:!1,data:{}}),nt="https://powerful-unbiased-gannet.ngrok-free.app",C={initData:Telegram.WebApp.initData||"",initDataUnsafe:Telegram.WebApp.initDataUnsafe||{},MainButton:Telegram.WebApp.MainButton,init(e){Telegram.WebApp.ready(),Telegram.WebApp.MainButton.setParams({text:"CLOSE WEBVIEW",is_visible:!0}).onClick(C.close)},expand(){Telegram.WebApp.expand()},close(){Telegram.WebApp.close()},toggleMainButton(e){const t=Telegram.WebApp.MainButton;t.isVisible?(t.hide(),e.innerHTML="Show Main Button"):(t.show(),e.innerHTML="Hide Main Button")},async checkInitData(){if(C.initDataUnsafe.query_id&&C.initData){let e={method:"GET",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"69420"}};const t=await fetch(`${nt}/validate?${C.initData}`,e),l=await t.json();if(console.log("respData:",l),t.ok){let s=new URLSearchParams(C.initData),n=Object.fromEntries(s);return console.log("initData:",n),L.set({valid:!0,data:n}),n}else return L.set({valid:!1,data:{}}),{}}return{}}};function st(e){let t,l,s=e[5].message+"",n;return{c(){t=g("div"),l=b("Error: "),n=b(s),this.h()},l(a){t=k(a,"DIV",{class:!0});var r=B(t);l=_(r,"Error: "),n=_(r,s),r.forEach(E),this.h()},h(){D(t,"class","text-center")},m(a,r){S(a,t,r),c(t,l),c(t,n)},p(a,r){r&4&&s!==(s=a[5].message+"")&&y(n,s)},d(a){a&&E(t)}}}function lt(e){let t,l=JSON.stringify(e[4],null,2)+"",s;return{c(){t=g("pre"),s=b(l),this.h()},l(n){t=k(n,"PRE",{class:!0});var a=B(t);s=_(a,l),a.forEach(E),this.h()},h(){D(t,"class","pre")},m(n,a){S(n,t,a),c(t,s)},p(n,a){a&4&&l!==(l=JSON.stringify(n[4],null,2)+"")&&y(s,l)},d(n){n&&E(t)}}}function rt(e){let t,l="Validating...";return{c(){t=g("div"),t.textContent=l,this.h()},l(s){t=k(s,"DIV",{class:!0,"data-svelte-h":!0}),U(t)!=="svelte-2l0okz"&&(t.textContent=l),this.h()},h(){D(t,"class","text-center")},m(s,n){S(s,t,n)},p:P,d(s){s&&E(t)}}}function ct(e){let t,l,s="Go to test page",n,a,r,u,p,h,w,d=JSON.stringify(e[0],null,2)+"",f,W,M,m,N="Validate data",V,x,I,R,o={ctx:e,current:null,token:null,hasCatch:!0,pending:rt,then:lt,catch:st,value:4,error:5};return J(x=e[2],o),{c(){t=g("div"),l=g("a"),l.textContent=s,n=O(),a=g("pre"),r=b("    Valid: "),u=b(e[1]),p=b(" "),h=g("br"),w=b(`
    `),f=b(d),W=b(`
  `),M=O(),m=g("button"),m.textContent=N,V=O(),o.block.c(),this.h()},l(T){t=k(T,"DIV",{class:!0});var i=B(t);l=k(i,"A",{href:!0,"data-svelte-h":!0}),U(l)!=="svelte-1um8ttw"&&(l.textContent=s),n=j(i),a=k(i,"PRE",{class:!0});var v=B(a);r=_(v,"    Valid: "),u=_(v,e[1]),p=_(v," "),h=k(v,"BR",{}),w=_(v,`
    `),f=_(v,d),W=_(v,`
  `),v.forEach(E),M=j(i),m=k(i,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),U(m)!=="svelte-zf5j67"&&(m.textContent=N),V=j(i),o.block.l(i),i.forEach(E),this.h()},h(){D(l,"href",et+"/test"),D(a,"class","pre"),D(m,"type","button"),D(m,"class","btn variant-filled rounded-md"),D(t,"class","container container mx-auto p-8 space-y-8")},m(T,i){S(T,t,i),c(t,l),c(t,n),c(t,a),c(a,r),c(a,u),c(a,p),c(a,h),c(a,w),c(a,f),c(a,W),c(t,M),c(t,m),c(t,V),o.block.m(t,o.anchor=null),o.mount=()=>t,o.anchor=null,I||(R=Z(m,"click",e[3]),I=!0)},p(T,[i]){e=T,i&2&&y(u,e[1]),i&1&&d!==(d=JSON.stringify(e[0],null,2)+"")&&y(f,d),o.ctx=e,i&4&&x!==(x=e[2])&&J(x,o)||at(o,e,i)},i:P,o:P,d(T){T&&E(t),o.block.d(),o.token=null,o=null,I=!1,R()}}}function it(e,t,l){let s,n=!1;L.subscribe(u=>{l(0,s=u.data),l(1,n=u.valid)});let a=C.checkInitData();C.init();function r(u){try{l(2,a=C.checkInitData())}catch(p){console.error(p)}}return[s,n,a,r]}class ht extends X{constructor(t){super(),Y(this,t,it,ct,G,{})}}export{ht as component};
