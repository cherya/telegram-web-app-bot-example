import{i as L,f as N,h as A,j as O,s as z,n as P,k as G}from"../chunks/scheduler.SiZdlcgb.js";import{p as J,t as F,b as K,d as Q,S as X,i as Y,g as b,s as y,m as T,h as v,j as E,y as $,c as B,n as w,f as d,k as _,a as M,x as o,z as Z,o as j}from"../chunks/index.ndoocLBO.js";import{w as ee,b as te}from"../chunks/paths.5gFWY87k.js";function H(t,e){const s=e.token={};function n(r,a,l,u){if(e.token!==s)return;e.resolved=u;let h=e.ctx;l!==void 0&&(h=h.slice(),h[l]=u);const p=r&&(e.current=r)(h);let C=!1;e.block&&(e.blocks?e.blocks.forEach((k,g)=>{g!==a&&k&&(J(),F(k,1,1,()=>{e.blocks[g]===k&&(e.blocks[g]=null)}),K())}):e.block.d(1),p.c(),Q(p,1),p.m(e.mount(),e.anchor),C=!0),e.block=p,e.blocks&&(e.blocks[a]=p),C&&O()}if(L(t)){const r=N();if(t.then(a=>{A(r),n(e.then,1,e.value,a),A(null)},a=>{if(A(r),n(e.catch,2,e.error,a),A(null),!e.hasCatch)throw a}),e.current!==e.pending)return n(e.pending,0),!0}else{if(e.current!==e.then)return n(e.then,1,e.value,t),!0;e.resolved=t}}function ae(t,e,s){const n=e.slice(),{resolved:r}=t;t.current===t.then&&(n[t.value]=r),t.current===t.catch&&(n[t.error]=r),t.block.p(n,s)}const S=ee({valid:!1,data:{}}),se="https://powerful-unbiased-gannet.ngrok-free.app",f={initData:Telegram.WebApp.initData||"",initDataUnsafe:Telegram.WebApp.initDataUnsafe||{},MainButton:Telegram.WebApp.MainButton,init(t){Telegram.WebApp.ready(),Telegram.WebApp.MainButton.setParams({text:"Close",is_visible:!0}).onClick(f.close)},expand(){Telegram.WebApp.expand()},close(){Telegram.WebApp.close()},toggleMainButton(t){const e=Telegram.WebApp.MainButton;e.isVisible?(e.hide(),t.innerHTML="Show Main Button"):(e.show(),t.innerHTML="Hide Main Button")},async checkInitData(){if(f.initDataUnsafe.query_id&&f.initData){let t={method:"GET",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"69420"}};const e=await fetch(`${se}/validate?${f.initData}`,t),s=await e.json();return e.ok?(S.set({valid:!0,data:s}),s):(S.set({valid:!1,data:{}}),{})}return{}}};function ne(t){let e,s,n=t[5].message+"",r;return{c(){e=b("div"),s=T("Error: "),r=T(n),this.h()},l(a){e=v(a,"DIV",{class:!0});var l=E(e);s=w(l,"Error: "),r=w(l,n),l.forEach(d),this.h()},h(){_(e,"class","text-center")},m(a,l){M(a,e,l),o(e,s),o(e,r)},p(a,l){l&2&&n!==(n=a[5].message+"")&&j(r,n)},d(a){a&&d(e)}}}function re(t){let e,s=JSON.stringify(t[4],null,2)+"",n;return{c(){e=b("pre"),n=T(s),this.h()},l(r){e=v(r,"PRE",{class:!0});var a=E(e);n=w(a,s),a.forEach(d),this.h()},h(){_(e,"class","pre svelte-t70oqn")},m(r,a){M(r,e,a),o(e,n)},p(r,a){a&2&&s!==(s=JSON.stringify(r[4],null,2)+"")&&j(n,s)},d(r){r&&d(e)}}}function le(t){let e;return{c(){e=b("div"),this.h()},l(s){e=v(s,"DIV",{class:!0}),E(e).forEach(d),this.h()},h(){_(e,"class","placeholder animate-pulse")},m(s,n){M(s,e,n)},p:P,d(s){s&&d(e)}}}function ce(t){let e,s,n="Go to test page",r,a,l,u,h,p,C=f.initData+"",k,g,m,q="Validate data",W,x,V,U,i={ctx:t,current:null,token:null,hasCatch:!0,pending:le,then:re,catch:ne,value:4,error:5};return H(x=t[1],i),{c(){e=b("div"),s=b("a"),s.textContent=n,r=y(),a=b("pre"),l=T("Valid: "),u=T(t[0]),h=y(),p=b("pre"),k=T(C),g=y(),m=b("button"),m.textContent=q,W=y(),i.block.c(),this.h()},l(D){e=v(D,"DIV",{class:!0});var c=E(e);s=v(c,"A",{href:!0,"data-svelte-h":!0}),$(s)!=="svelte-1um8ttw"&&(s.textContent=n),r=B(c),a=v(c,"PRE",{class:!0});var I=E(a);l=w(I,"Valid: "),u=w(I,t[0]),I.forEach(d),h=B(c),p=v(c,"PRE",{class:!0});var R=E(p);k=w(R,C),R.forEach(d),g=B(c),m=v(c,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),$(m)!=="svelte-zf5j67"&&(m.textContent=q),W=B(c),i.block.l(c),c.forEach(d),this.h()},h(){_(s,"href",te+"/test"),_(a,"class","pre svelte-t70oqn"),_(p,"class","pre svelte-t70oqn"),_(m,"type","button"),_(m,"class","btn variant-filled rounded-md"),_(e,"class","container container mx-auto p-8 space-y-8")},m(D,c){M(D,e,c),o(e,s),o(e,r),o(e,a),o(a,l),o(a,u),o(e,h),o(e,p),o(p,k),o(e,g),o(e,m),o(e,W),i.block.m(e,i.anchor=null),i.mount=()=>e,i.anchor=null,V||(U=Z(m,"click",t[2]),V=!0)},p(D,[c]){t=D,c&1&&j(u,t[0]),i.ctx=t,c&2&&x!==(x=t[1])&&H(x,i)||ae(i,t,c)},i:P,o:P,d(D){D&&d(e),i.block.d(),i.token=null,i=null,V=!1,U()}}}function oe(t,e,s){let n=!1,r=S.subscribe(u=>{s(0,n=u.valid)}),a=f.checkInitData();a.then(()=>{f.init()}).catch(u=>{console.error(u)});function l(u){try{s(1,a=f.checkInitData())}catch(h){console.error(h)}}return G(r),[n,a,l]}class he extends X{constructor(e){super(),Y(this,e,oe,ce,z,{})}}export{he as component};
