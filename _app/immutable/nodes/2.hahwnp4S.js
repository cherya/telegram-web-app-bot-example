import{i as L,f as z,h as y,j as H,s as q,n as j,k as G}from"../chunks/scheduler.SiZdlcgb.js";import{p as $,t as F,b as K,d as Q,S as X,i as Y,g as v,s as A,m as T,h as k,j as x,y as I,c as B,n as w,f as _,k as m,a as S,x as u,z as Z,o as M}from"../chunks/index.ndoocLBO.js";import{w as tt,b as et}from"../chunks/paths.t3GxliUo.js";function J(e,t){const n=t.token={};function a(r,s,l,h){if(t.token!==n)return;t.resolved=h;let i=t.ctx;l!==void 0&&(i=i.slice(),i[l]=h);const o=r&&(t.current=r)(i);let b=!1;t.block&&(t.blocks?t.blocks.forEach((f,D)=>{D!==s&&f&&($(),F(f,1,1,()=>{t.blocks[D]===f&&(t.blocks[D]=null)}),K())}):t.block.d(1),o.c(),Q(o,1),o.m(t.mount(),t.anchor),b=!0),t.block=o,t.blocks&&(t.blocks[s]=o),b&&H()}if(L(e)){const r=z();if(e.then(s=>{y(r),a(t.then,1,t.value,s),y(null)},s=>{if(y(r),a(t.catch,2,t.error,s),y(null),!t.hasCatch)throw s}),t.current!==t.pending)return a(t.pending,0),!0}else{if(t.current!==t.then)return a(t.then,1,t.value,e),!0;t.resolved=e}}function at(e,t,n){const a=t.slice(),{resolved:r}=e;e.current===e.then&&(a[e.value]=r),e.current===e.catch&&(a[e.error]=r),e.block.p(a,n)}const O=tt({valid:!1,data:{}}),st="https://powerful-unbiased-gannet.ngrok-free.app",g={initData:Telegram.WebApp.initData||"",initDataUnsafe:Telegram.WebApp.initDataUnsafe||{},MainButton:Telegram.WebApp.MainButton,init(e){Telegram.WebApp.ready(),Telegram.WebApp.MainButton.setParams({text:"Close",is_visible:!0}).onClick(g.close)},expand(){Telegram.WebApp.expand()},close(){Telegram.WebApp.close()},toggleMainButton(e){const t=Telegram.WebApp.MainButton;t.isVisible?(t.hide(),e.innerHTML="Show Main Button"):(t.show(),e.innerHTML="Hide Main Button")},async checkInitData(){if(g.initDataUnsafe.query_id&&g.initData){let e={method:"GET",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"69420"}};const t=await fetch(`${st}/validate?${g.initData}`,e);if(await t.json(),t.ok){let n=new URLSearchParams(g.initData),a=Object.fromEntries(n);return O.set({valid:!0,data:a}),a}else return O.set({valid:!1,data:{}}),{}}return{}}};function nt(e){let t,n,a=e[6].message+"",r;return{c(){t=v("div"),n=T("Error: "),r=T(a),this.h()},l(s){t=k(s,"DIV",{class:!0});var l=x(t);n=w(l,"Error: "),r=w(l,a),l.forEach(_),this.h()},h(){m(t,"class","text-center")},m(s,l){S(s,t,l),u(t,n),u(t,r)},p(s,l){l&4&&a!==(a=s[6].message+"")&&M(r,a)},d(s){s&&_(t)}}}function rt(e){let t,n=JSON.stringify(e[5],null,2)+"",a;return{c(){t=v("pre"),a=T(n),this.h()},l(r){t=k(r,"PRE",{class:!0});var s=x(t);a=w(s,n),s.forEach(_),this.h()},h(){m(t,"class","pre")},m(r,s){S(r,t,s),u(t,a)},p(r,s){s&4&&n!==(n=JSON.stringify(r[5],null,2)+"")&&M(a,n)},d(r){r&&_(t)}}}function lt(e){let t,n="Validating...";return{c(){t=v("div"),t.textContent=n,this.h()},l(a){t=k(a,"DIV",{class:!0,"data-svelte-h":!0}),I(t)!=="svelte-2l0okz"&&(t.textContent=n),this.h()},h(){m(t,"class","text-center")},m(a,r){S(a,t,r)},p:j,d(a){a&&_(t)}}}function ct(e){let t,n,a="Go to test page",r,s,l,h,i,o,b=JSON.stringify(e[0],null,2)+"",f,D,d,U="Validate data",V,E,W,N,p={ctx:e,current:null,token:null,hasCatch:!0,pending:lt,then:rt,catch:nt,value:5,error:6};return J(E=e[2],p),{c(){t=v("div"),n=v("a"),n.textContent=a,r=A(),s=v("pre"),l=T("Valid: "),h=T(e[1]),i=A(),o=v("pre"),f=T(b),D=A(),d=v("button"),d.textContent=U,V=A(),p.block.c(),this.h()},l(C){t=k(C,"DIV",{class:!0});var c=x(t);n=k(c,"A",{href:!0,"data-svelte-h":!0}),I(n)!=="svelte-1um8ttw"&&(n.textContent=a),r=B(c),s=k(c,"PRE",{class:!0});var P=x(s);l=w(P,"Valid: "),h=w(P,e[1]),P.forEach(_),i=B(c),o=k(c,"PRE",{class:!0});var R=x(o);f=w(R,b),R.forEach(_),D=B(c),d=k(c,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),I(d)!=="svelte-zf5j67"&&(d.textContent=U),V=B(c),p.block.l(c),c.forEach(_),this.h()},h(){m(n,"href",et+"/test"),m(s,"class","pre"),m(o,"class","pre"),m(d,"type","button"),m(d,"class","btn variant-filled rounded-md"),m(t,"class","container container mx-auto p-8 space-y-8")},m(C,c){S(C,t,c),u(t,n),u(t,r),u(t,s),u(s,l),u(s,h),u(t,i),u(t,o),u(o,f),u(t,D),u(t,d),u(t,V),p.block.m(t,p.anchor=null),p.mount=()=>t,p.anchor=null,W||(N=Z(d,"click",e[3]),W=!0)},p(C,[c]){e=C,c&2&&M(h,e[1]),c&1&&b!==(b=JSON.stringify(e[0],null,2)+"")&&M(f,b),p.ctx=e,c&4&&E!==(E=e[2])&&J(E,p)||at(p,e,c)},i:j,o:j,d(C){C&&_(t),p.block.d(),p.token=null,p=null,W=!1,N()}}}function it(e,t,n){let a,r=!1,s=O.subscribe(i=>{n(0,a=i.data),n(1,r=i.valid)}),l=g.checkInitData();l.then(i=>{g.init()}).catch(i=>{console.error(i)});function h(i){try{n(2,l=g.checkInitData())}catch(o){console.error(o)}}return G(s),[a,r,l,h]}class ht extends X{constructor(t){super(),Y(this,t,it,ct,q,{})}}export{ht as component};
