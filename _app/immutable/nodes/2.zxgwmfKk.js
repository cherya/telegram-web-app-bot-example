import{i as L,f as N,h as A,j as O,s as z,n as P,k as G}from"../chunks/scheduler.SiZdlcgb.js";import{p as J,t as F,b as K,d as Q,S as X,i as Y,g as b,s as y,m as T,h as v,j as E,y as $,c as B,n as w,f as d,k as _,a as M,x as o,z as Z,o as j}from"../chunks/index.ndoocLBO.js";import{w as tt,b as et}from"../chunks/paths.wVIKBT8z.js";function H(e,t){const s=t.token={};function n(r,a,l,u){if(t.token!==s)return;t.resolved=u;let h=t.ctx;l!==void 0&&(h=h.slice(),h[l]=u);const p=r&&(t.current=r)(h);let C=!1;t.block&&(t.blocks?t.blocks.forEach((f,k)=>{k!==a&&f&&(J(),F(f,1,1,()=>{t.blocks[k]===f&&(t.blocks[k]=null)}),K())}):t.block.d(1),p.c(),Q(p,1),p.m(t.mount(),t.anchor),C=!0),t.block=p,t.blocks&&(t.blocks[a]=p),C&&O()}if(L(e)){const r=N();if(e.then(a=>{A(r),n(t.then,1,t.value,a),A(null)},a=>{if(A(r),n(t.catch,2,t.error,a),A(null),!t.hasCatch)throw a}),t.current!==t.pending)return n(t.pending,0),!0}else{if(t.current!==t.then)return n(t.then,1,t.value,e),!0;t.resolved=e}}function at(e,t,s){const n=t.slice(),{resolved:r}=e;e.current===e.then&&(n[e.value]=r),e.current===e.catch&&(n[e.error]=r),e.block.p(n,s)}const S=tt({valid:!1,data:{}}),st="https://powerful-unbiased-gannet.ngrok-free.app",D={initData:Telegram.WebApp.initData||"",initDataUnsafe:Telegram.WebApp.initDataUnsafe||{},MainButton:Telegram.WebApp.MainButton,init(e){Telegram.WebApp.ready(),Telegram.WebApp.MainButton.setParams({text:"Close",is_visible:!0}).onClick(D.close)},expand(){Telegram.WebApp.expand()},close(){Telegram.WebApp.close()},toggleMainButton(e){const t=Telegram.WebApp.MainButton;t.isVisible?(t.hide(),e.innerHTML="Show Main Button"):(t.show(),e.innerHTML="Hide Main Button")},async checkInitData(){if(D.initData){let e={method:"GET",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"69420"}};const t=await fetch(`${st}/validate?${D.initData}`,e),s=await t.json();return t.ok?(S.set({valid:!0,data:s}),s):(S.set({valid:!1,data:{}}),{})}return{}}};function nt(e){let t,s,n=e[5].message+"",r;return{c(){t=b("div"),s=T("Error: "),r=T(n),this.h()},l(a){t=v(a,"DIV",{class:!0});var l=E(t);s=w(l,"Error: "),r=w(l,n),l.forEach(d),this.h()},h(){_(t,"class","text-center")},m(a,l){M(a,t,l),o(t,s),o(t,r)},p(a,l){l&2&&n!==(n=a[5].message+"")&&j(r,n)},d(a){a&&d(t)}}}function rt(e){let t,s=JSON.stringify(e[4],null,2)+"",n;return{c(){t=b("pre"),n=T(s),this.h()},l(r){t=v(r,"PRE",{class:!0});var a=E(t);n=w(a,s),a.forEach(d),this.h()},h(){_(t,"class","pre svelte-t70oqn")},m(r,a){M(r,t,a),o(t,n)},p(r,a){a&2&&s!==(s=JSON.stringify(r[4],null,2)+"")&&j(n,s)},d(r){r&&d(t)}}}function lt(e){let t;return{c(){t=b("div"),this.h()},l(s){t=v(s,"DIV",{class:!0}),E(t).forEach(d),this.h()},h(){_(t,"class","placeholder animate-pulse")},m(s,n){M(s,t,n)},p:P,d(s){s&&d(t)}}}function ct(e){let t,s,n="Go to test page",r,a,l,u,h,p,C=D.initData+"",f,k,m,q="Validate data",W,x,V,R,i={ctx:e,current:null,token:null,hasCatch:!0,pending:lt,then:rt,catch:nt,value:4,error:5};return H(x=e[1],i),{c(){t=b("div"),s=b("a"),s.textContent=n,r=y(),a=b("pre"),l=T("Valid: "),u=T(e[0]),h=y(),p=b("pre"),f=T(C),k=y(),m=b("button"),m.textContent=q,W=y(),i.block.c(),this.h()},l(g){t=v(g,"DIV",{class:!0});var c=E(t);s=v(c,"A",{href:!0,"data-svelte-h":!0}),$(s)!=="svelte-1um8ttw"&&(s.textContent=n),r=B(c),a=v(c,"PRE",{class:!0});var I=E(a);l=w(I,"Valid: "),u=w(I,e[0]),I.forEach(d),h=B(c),p=v(c,"PRE",{class:!0});var U=E(p);f=w(U,C),U.forEach(d),k=B(c),m=v(c,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),$(m)!=="svelte-zf5j67"&&(m.textContent=q),W=B(c),i.block.l(c),c.forEach(d),this.h()},h(){_(s,"href",et+"/test"),_(a,"class","pre svelte-t70oqn"),_(p,"class","pre svelte-t70oqn"),_(m,"type","button"),_(m,"class","btn variant-filled rounded-md"),_(t,"class","container container mx-auto p-8 space-y-8")},m(g,c){M(g,t,c),o(t,s),o(t,r),o(t,a),o(a,l),o(a,u),o(t,h),o(t,p),o(p,f),o(t,k),o(t,m),o(t,W),i.block.m(t,i.anchor=null),i.mount=()=>t,i.anchor=null,V||(R=Z(m,"click",e[2]),V=!0)},p(g,[c]){e=g,c&1&&j(u,e[0]),i.ctx=e,c&2&&x!==(x=e[1])&&H(x,i)||at(i,e,c)},i:P,o:P,d(g){g&&d(t),i.block.d(),i.token=null,i=null,V=!1,R()}}}function ot(e,t,s){let n=!1,r=S.subscribe(u=>{s(0,n=u.valid)}),a=D.checkInitData();a.then(()=>{D.init()}).catch(u=>{console.error(u)});function l(u){try{s(1,a=D.checkInitData())}catch(h){console.error(h)}}return G(r),[n,a,l]}class ht extends X{constructor(t){super(),Y(this,t,ot,ct,z,{})}}export{ht as component};
