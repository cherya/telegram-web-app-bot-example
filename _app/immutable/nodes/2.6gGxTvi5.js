import{i as J,f as L,h as A,j as H,s as z,n as j,k as G}from"../chunks/scheduler.SiZdlcgb.js";import{p as $,t as F,b as K,d as Q,S as X,i as Y,g as v,s as x,m as E,h as k,j as T,y as N,c as B,n as C,f as h,k as _,a as S,x as u,z as Z,o as M}from"../chunks/index.ndoocLBO.js";import{w as ee,b as te}from"../chunks/paths.BP_mmDUv.js";function R(t,e){const a=e.token={};function n(r,s,l,d){if(e.token!==a)return;e.resolved=d;let o=e.ctx;l!==void 0&&(o=o.slice(),o[l]=d);const i=r&&(e.current=r)(o);let b=!1;e.block&&(e.blocks?e.blocks.forEach((f,D)=>{D!==s&&f&&($(),F(f,1,1,()=>{e.blocks[D]===f&&(e.blocks[D]=null)}),K())}):e.block.d(1),i.c(),Q(i,1),i.m(e.mount(),e.anchor),b=!0),e.block=i,e.blocks&&(e.blocks[s]=i),b&&H()}if(J(t)){const r=L();if(t.then(s=>{A(r),n(e.then,1,e.value,s),A(null)},s=>{if(A(r),n(e.catch,2,e.error,s),A(null),!e.hasCatch)throw s}),e.current!==e.pending)return n(e.pending,0),!0}else{if(e.current!==e.then)return n(e.then,1,e.value,t),!0;e.resolved=t}}function ae(t,e,a){const n=e.slice(),{resolved:r}=t;t.current===t.then&&(n[t.value]=r),t.current===t.catch&&(n[t.error]=r),t.block.p(n,a)}const I=ee({valid:!1,data:{}}),se="https://powerful-unbiased-gannet.ngrok-free.app",g={initData:Telegram.WebApp.initData||"",initDataUnsafe:Telegram.WebApp.initDataUnsafe||{},MainButton:Telegram.WebApp.MainButton,init(t){Telegram.WebApp.ready(),Telegram.WebApp.MainButton.setParams({text:"Close",is_visible:!0}).onClick(g.close)},expand(){Telegram.WebApp.expand()},close(){Telegram.WebApp.close()},toggleMainButton(t){const e=Telegram.WebApp.MainButton;e.isVisible?(e.hide(),t.innerHTML="Show Main Button"):(e.show(),t.innerHTML="Hide Main Button")},async checkInitData(){if(g.initDataUnsafe.query_id&&g.initData){let t={method:"GET",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"69420"}};const e=await fetch(`${se}/validate?${g.initData}`,t);if(await e.json(),e.ok){let a=new URLSearchParams(g.initData),n=Object.fromEntries(a);return I.set({valid:!0,data:n}),n}else return I.set({valid:!1,data:{}}),{}}return{}}};function ne(t){let e,a,n=t[6].message+"",r;return{c(){e=v("div"),a=E("Error: "),r=E(n),this.h()},l(s){e=k(s,"DIV",{class:!0});var l=T(e);a=C(l,"Error: "),r=C(l,n),l.forEach(h),this.h()},h(){_(e,"class","text-center")},m(s,l){S(s,e,l),u(e,a),u(e,r)},p(s,l){l&4&&n!==(n=s[6].message+"")&&M(r,n)},d(s){s&&h(e)}}}function re(t){let e,a=JSON.stringify(t[5],null,2)+"",n;return{c(){e=v("pre"),n=E(a),this.h()},l(r){e=k(r,"PRE",{class:!0});var s=T(e);n=C(s,a),s.forEach(h),this.h()},h(){_(e,"class","pre svelte-t70oqn")},m(r,s){S(r,e,s),u(e,n)},p(r,s){s&4&&a!==(a=JSON.stringify(r[5],null,2)+"")&&M(n,a)},d(r){r&&h(e)}}}function le(t){let e;return{c(){e=v("div"),this.h()},l(a){e=k(a,"DIV",{class:!0}),T(e).forEach(h),this.h()},h(){_(e,"class","placeholder-circle w-16")},m(a,n){S(a,e,n)},p:j,d(a){a&&h(e)}}}function ce(t){let e,a,n="Go to test page",r,s,l,d,o,i,b=JSON.stringify(t[0],null,2)+"",f,D,m,O="Validate data",W,y,P,U,p={ctx:t,current:null,token:null,hasCatch:!0,pending:le,then:re,catch:ne,value:5,error:6};return R(y=t[2],p),{c(){e=v("div"),a=v("a"),a.textContent=n,r=x(),s=v("pre"),l=E("Valid: "),d=E(t[1]),o=x(),i=v("pre"),f=E(b),D=x(),m=v("button"),m.textContent=O,W=x(),p.block.c(),this.h()},l(w){e=k(w,"DIV",{class:!0});var c=T(e);a=k(c,"A",{href:!0,"data-svelte-h":!0}),N(a)!=="svelte-1um8ttw"&&(a.textContent=n),r=B(c),s=k(c,"PRE",{class:!0});var V=T(s);l=C(V,"Valid: "),d=C(V,t[1]),V.forEach(h),o=B(c),i=k(c,"PRE",{class:!0});var q=T(i);f=C(q,b),q.forEach(h),D=B(c),m=k(c,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),N(m)!=="svelte-zf5j67"&&(m.textContent=O),W=B(c),p.block.l(c),c.forEach(h),this.h()},h(){_(a,"href",te+"/test"),_(s,"class","pre svelte-t70oqn"),_(i,"class","pre svelte-t70oqn"),_(m,"type","button"),_(m,"class","btn variant-filled rounded-md"),_(e,"class","container container mx-auto p-8 space-y-8")},m(w,c){S(w,e,c),u(e,a),u(e,r),u(e,s),u(s,l),u(s,d),u(e,o),u(e,i),u(i,f),u(e,D),u(e,m),u(e,W),p.block.m(e,p.anchor=null),p.mount=()=>e,p.anchor=null,P||(U=Z(m,"click",t[3]),P=!0)},p(w,[c]){t=w,c&2&&M(d,t[1]),c&1&&b!==(b=JSON.stringify(t[0],null,2)+"")&&M(f,b),p.ctx=t,c&4&&y!==(y=t[2])&&R(y,p)||ae(p,t,c)},i:j,o:j,d(w){w&&h(e),p.block.d(),p.token=null,p=null,P=!1,U()}}}function oe(t,e,a){let n,r=!1,s=I.subscribe(o=>{a(0,n=o.data),a(1,r=o.valid)}),l=g.checkInitData();l.then(()=>{g.init()}).catch(o=>{console.error(o)});function d(o){try{a(2,l=g.checkInitData())}catch(i){console.error(i)}}return G(s),[n,r,l,d]}class he extends X{constructor(e){super(),Y(this,e,oe,ce,z,{})}}export{he as component};
