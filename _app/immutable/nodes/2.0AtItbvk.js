import{i as $,f as H,h as A,j as N,s as z,n as V,k as G}from"../chunks/scheduler.SiZdlcgb.js";import{p as J,t as F,b as K,d as Q,S as X,i as Y,g as f,s as y,m as E,h as v,j as T,y as L,c as B,n as w,f as d,k as _,a as M,x as o,z as Z,o as I}from"../chunks/index.ndoocLBO.js";import{w as ee,b as te}from"../chunks/paths.NfPAhhMe.js";function O(t,e){const s=e.token={};function n(r,a,l,i){if(e.token!==s)return;e.resolved=i;let h=e.ctx;l!==void 0&&(h=h.slice(),h[l]=i);const p=r&&(e.current=r)(h);let C=!1;e.block&&(e.blocks?e.blocks.forEach((k,g)=>{g!==a&&k&&(J(),F(k,1,1,()=>{e.blocks[g]===k&&(e.blocks[g]=null)}),K())}):e.block.d(1),p.c(),Q(p,1),p.m(e.mount(),e.anchor),C=!0),e.block=p,e.blocks&&(e.blocks[a]=p),C&&N()}if($(t)){const r=H();if(t.then(a=>{A(r),n(e.then,1,e.value,a),A(null)},a=>{if(A(r),n(e.catch,2,e.error,a),A(null),!e.hasCatch)throw a}),e.current!==e.pending)return n(e.pending,0),!0}else{if(e.current!==e.then)return n(e.then,1,e.value,t),!0;e.resolved=t}}function ae(t,e,s){const n=e.slice(),{resolved:r}=t;t.current===t.then&&(n[t.value]=r),t.current===t.catch&&(n[t.error]=r),t.block.p(n,s)}const j=ee({valid:!1,data:{}}),se="https://powerful-unbiased-gannet.ngrok-free.app",b={initData:Telegram.WebApp.initData||"",initDataUnsafe:Telegram.WebApp.initDataUnsafe||{},MainButton:Telegram.WebApp.MainButton,init(t){Telegram.WebApp.ready(),Telegram.WebApp.MainButton.setParams({text:"Close",is_visible:!0}).onClick(b.close)},expand(){Telegram.WebApp.expand()},close(){Telegram.WebApp.close()},toggleMainButton(t){const e=Telegram.WebApp.MainButton;e.isVisible?(e.hide(),t.innerHTML="Show Main Button"):(e.show(),t.innerHTML="Hide Main Button")},async checkInitData(){if(b.initDataUnsafe.query_id&&b.initData){let t={method:"GET",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"69420"}};const e=await fetch(`${se}/validate?${b.initData}`,t);if(await e.json(),e.ok){let s=new URLSearchParams(b.initData),n=Object.fromEntries(s);return j.set({valid:!0,data:n}),n}else return j.set({valid:!1,data:{}}),{}}return{}}};function ne(t){let e,s,n=t[6].message+"",r;return{c(){e=f("div"),s=E("Error: "),r=E(n),this.h()},l(a){e=v(a,"DIV",{class:!0});var l=T(e);s=w(l,"Error: "),r=w(l,n),l.forEach(d),this.h()},h(){_(e,"class","text-center")},m(a,l){M(a,e,l),o(e,s),o(e,r)},p(a,l){l&2&&n!==(n=a[6].message+"")&&I(r,n)},d(a){a&&d(e)}}}function re(t){let e,s=JSON.stringify(t[5],null,2)+"",n;return{c(){e=f("pre"),n=E(s),this.h()},l(r){e=v(r,"PRE",{class:!0});var a=T(e);n=w(a,s),a.forEach(d),this.h()},h(){_(e,"class","pre svelte-t70oqn")},m(r,a){M(r,e,a),o(e,n)},p(r,a){a&2&&s!==(s=JSON.stringify(r[5],null,2)+"")&&I(n,s)},d(r){r&&d(e)}}}function le(t){let e;return{c(){e=f("div"),this.h()},l(s){e=v(s,"DIV",{class:!0}),T(e).forEach(d),this.h()},h(){_(e,"class","placeholder animate-pulse")},m(s,n){M(s,e,n)},p:V,d(s){s&&d(e)}}}function ce(t){let e,s,n="Go to test page",r,a,l,i,h,p,C=b.initData+"",k,g,m,U="Validate data",W,x,P,q,u={ctx:t,current:null,token:null,hasCatch:!0,pending:le,then:re,catch:ne,value:5,error:6};return O(x=t[1],u),{c(){e=f("div"),s=f("a"),s.textContent=n,r=y(),a=f("pre"),l=E("Valid: "),i=E(t[0]),h=y(),p=f("pre"),k=E(C),g=y(),m=f("button"),m.textContent=U,W=y(),u.block.c(),this.h()},l(D){e=v(D,"DIV",{class:!0});var c=T(e);s=v(c,"A",{href:!0,"data-svelte-h":!0}),L(s)!=="svelte-1um8ttw"&&(s.textContent=n),r=B(c),a=v(c,"PRE",{class:!0});var S=T(a);l=w(S,"Valid: "),i=w(S,t[0]),S.forEach(d),h=B(c),p=v(c,"PRE",{class:!0});var R=T(p);k=w(R,C),R.forEach(d),g=B(c),m=v(c,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),L(m)!=="svelte-zf5j67"&&(m.textContent=U),W=B(c),u.block.l(c),c.forEach(d),this.h()},h(){_(s,"href",te+"/test"),_(a,"class","pre svelte-t70oqn"),_(p,"class","pre svelte-t70oqn"),_(m,"type","button"),_(m,"class","btn variant-filled rounded-md"),_(e,"class","container container mx-auto p-8 space-y-8")},m(D,c){M(D,e,c),o(e,s),o(e,r),o(e,a),o(a,l),o(a,i),o(e,h),o(e,p),o(p,k),o(e,g),o(e,m),o(e,W),u.block.m(e,u.anchor=null),u.mount=()=>e,u.anchor=null,P||(q=Z(m,"click",t[2]),P=!0)},p(D,[c]){t=D,c&1&&I(i,t[0]),u.ctx=t,c&2&&x!==(x=t[1])&&O(x,u)||ae(u,t,c)},i:V,o:V,d(D){D&&d(e),u.block.d(),u.token=null,u=null,P=!1,q()}}}function oe(t,e,s){let n=!1,r=j.subscribe(i=>{i.data,s(0,n=i.valid)}),a=b.checkInitData();a.then(()=>{b.init()}).catch(i=>{console.error(i)});function l(i){try{s(1,a=b.checkInitData())}catch(h){console.error(h)}}return G(r),[n,a,l]}class he extends X{constructor(e){super(),Y(this,e,oe,ce,z,{})}}export{he as component};
