import{i as N,f as O,h as A,j as z,s as G,n as P,k as J}from"../chunks/scheduler.SiZdlcgb.js";import{p as q,t as F,b as K,d as Q,S as X,i as Y,g as b,s as y,m as T,h as v,j as x,y as H,c as B,n as E,f as d,k as _,a as M,x as o,z as Z,o as j}from"../chunks/index.ndoocLBO.js";import{w as ee,b as te}from"../chunks/paths.B8wmBXix.js";function L(t,e){const s=e.token={};function n(l,a,r,u){if(e.token!==s)return;e.resolved=u;let h=e.ctx;r!==void 0&&(h=h.slice(),h[r]=u);const p=l&&(e.current=l)(h);let w=!1;e.block&&(e.blocks?e.blocks.forEach((f,g)=>{g!==a&&f&&(q(),F(f,1,1,()=>{e.blocks[g]===f&&(e.blocks[g]=null)}),K())}):e.block.d(1),p.c(),Q(p,1),p.m(e.mount(),e.anchor),w=!0),e.block=p,e.blocks&&(e.blocks[a]=p),w&&z()}if(N(t)){const l=O();if(t.then(a=>{A(l),n(e.then,1,e.value,a),A(null)},a=>{if(A(l),n(e.catch,2,e.error,a),A(null),!e.hasCatch)throw a}),e.current!==e.pending)return n(e.pending,0),!0}else{if(e.current!==e.then)return n(e.then,1,e.value,t),!0;e.resolved=t}}function ae(t,e,s){const n=e.slice(),{resolved:l}=t;t.current===t.then&&(n[t.value]=l),t.current===t.catch&&(n[t.error]=l),t.block.p(n,s)}const S=ee({valid:!1,data:{}}),se="https://powerful-unbiased-gannet.ngrok-free.app",D={initData:Telegram.WebApp.initData||"",initDataUnsafe:Telegram.WebApp.initDataUnsafe||{},MainButton:Telegram.WebApp.MainButton,init(t){Telegram.WebApp.ready(),Telegram.WebApp.MainButton.setParams({text:"Close",is_visible:!0}).onClick(D.close)},expand(){Telegram.WebApp.expand()},close(){Telegram.WebApp.close()},toggleMainButton(t){const e=Telegram.WebApp.MainButton;e.isVisible?(e.hide(),t.innerHTML="Show Main Button"):(e.show(),t.innerHTML="Hide Main Button")},async checkInitData(){if(D.initData){let t={method:"GET",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"69420"}};const e=await fetch(`${se}/validate?${D.initData}`,t),s=await e.json();return e.ok?(S.set({valid:!0,data:s}),s):(S.set({valid:!1,data:{}}),{})}return{}}};function ne(t){let e,s,n=t[5].message+"",l;return{c(){e=b("div"),s=T("Error: "),l=T(n),this.h()},l(a){e=v(a,"DIV",{class:!0});var r=x(e);s=E(r,"Error: "),l=E(r,n),r.forEach(d),this.h()},h(){_(e,"class","text-center")},m(a,r){M(a,e,r),o(e,s),o(e,l)},p(a,r){r&2&&n!==(n=a[5].message+"")&&j(l,n)},d(a){a&&d(e)}}}function le(t){let e,s=JSON.stringify(t[4],null,2)+"",n;return{c(){e=b("pre"),n=T(s),this.h()},l(l){e=v(l,"PRE",{class:!0});var a=x(e);n=E(a,s),a.forEach(d),this.h()},h(){_(e,"class","pre svelte-1glvxg9")},m(l,a){M(l,e,a),o(e,n)},p(l,a){a&2&&s!==(s=JSON.stringify(l[4],null,2)+"")&&j(n,s)},d(l){l&&d(e)}}}function re(t){let e;return{c(){e=b("div"),this.h()},l(s){e=v(s,"DIV",{class:!0}),x(e).forEach(d),this.h()},h(){_(e,"class","placeholder animate-pulse")},m(s,n){M(s,e,n)},p:P,d(s){s&&d(e)}}}function ce(t){let e,s,n="Go to test page",l,a,r,u,h,p,w=D.initData+"",f,g,m,R="Validate data",W,C,V,U,i={ctx:t,current:null,token:null,hasCatch:!0,pending:re,then:le,catch:ne,value:4,error:5};return L(C=t[1],i),{c(){e=b("div"),s=b("a"),s.textContent=n,l=y(),a=b("pre"),r=T("Valid: "),u=T(t[0]),h=y(),p=b("pre"),f=T(w),g=y(),m=b("button"),m.textContent=R,W=y(),i.block.c(),this.h()},l(k){e=v(k,"DIV",{class:!0});var c=x(e);s=v(c,"A",{href:!0,"data-svelte-h":!0}),H(s)!=="svelte-1um8ttw"&&(s.textContent=n),l=B(c),a=v(c,"PRE",{class:!0});var I=x(a);r=E(I,"Valid: "),u=E(I,t[0]),I.forEach(d),h=B(c),p=v(c,"PRE",{class:!0});var $=x(p);f=E($,w),$.forEach(d),g=B(c),m=v(c,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),H(m)!=="svelte-zf5j67"&&(m.textContent=R),W=B(c),i.block.l(c),c.forEach(d),this.h()},h(){_(s,"href",te+"/test"),_(a,"class","pre svelte-1glvxg9"),_(p,"class","pre initData svelte-1glvxg9"),_(m,"type","button"),_(m,"class","btn variant-filled rounded-md"),_(e,"class","container container mx-auto p-8 space-y-8")},m(k,c){M(k,e,c),o(e,s),o(e,l),o(e,a),o(a,r),o(a,u),o(e,h),o(e,p),o(p,f),o(e,g),o(e,m),o(e,W),i.block.m(e,i.anchor=null),i.mount=()=>e,i.anchor=null,V||(U=Z(m,"click",t[2]),V=!0)},p(k,[c]){t=k,c&1&&j(u,t[0]),i.ctx=t,c&2&&C!==(C=t[1])&&L(C,i)||ae(i,t,c)},i:P,o:P,d(k){k&&d(e),i.block.d(),i.token=null,i=null,V=!1,U()}}}function oe(t,e,s){let n=!1,l=S.subscribe(u=>{s(0,n=u.valid)}),a=D.checkInitData();a.then(()=>{D.init()}).catch(u=>{console.error(u)});function r(u){try{s(1,a=D.checkInitData())}catch(h){console.error(h)}}return J(l),[n,a,r]}class he extends X{constructor(e){super(),Y(this,e,oe,ce,G,{})}}export{he as component};
